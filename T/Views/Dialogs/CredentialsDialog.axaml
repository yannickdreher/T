<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:T.ViewModels"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             x:Class="T.Views.CredentialsDialog"
             x:DataType="vm:CredentialsDialogViewModel">
    
    <StackPanel Spacing="8" MinWidth="450">
        <!-- Error Message als InfoBar -->
        <ui:InfoBar IsOpen="{Binding HasError}"
                    Severity="Error"
                    Title="Authentication Failed"
                    Message="{Binding ErrorMessage}"
                    IsClosable="False"
                    Margin="0,0,0,8"/>

        <!-- Username -->
        <StackPanel Spacing="4">
            <TextBlock Text="Username"/>
            <TextBox Text="{Binding Username}" 
                     Watermark="Enter username"/>
        </StackPanel>

        <!-- Password -->
        <StackPanel Spacing="4">
            <TextBlock Text="Password"/>
            <TextBox Text="{Binding Password}" 
                     PasswordChar="●"
                     Watermark="Enter password (optional if using key)"/>
        </StackPanel>

        <!-- OR Separator -->
        <Grid ColumnDefinitions="*,Auto,*" Margin="0,8">
            <Border Grid.Column="0" 
                    Height="1" 
                    Background="{DynamicResource DividerStrokeColorDefaultBrush}"
                    VerticalAlignment="Center"/>
            <TextBlock Grid.Column="1" 
                       Text="OR" 
                       Margin="8,0"
                       FontSize="11"
                       FontWeight="SemiBold"
                       Opacity="0.6"
                       VerticalAlignment="Center"/>
            <Border Grid.Column="2" 
                    Height="1" 
                    Background="{DynamicResource DividerStrokeColorDefaultBrush}"
                    VerticalAlignment="Center"/>
        </Grid>

        <!-- Private Key -->
        <StackPanel Spacing="4">
            <TextBlock Text="Private Key File"/>
            <Grid ColumnDefinitions="*,Auto">
                <TextBox Grid.Column="0"
                         Text="{Binding PrivateKeyPath}"
                         Watermark="Path to private key file (optional)"
                         Margin="0,0,4,0"/>
                <Button Grid.Column="1"
                        Content="Browse..."
                        Command="{Binding BrowsePrivateKeyCommand}"/>
            </Grid>
        </StackPanel>

        <!-- Private Key Password -->
        <StackPanel Spacing="4">
            <TextBlock Text="Private Key Password"/>
            <TextBox Text="{Binding PrivateKeyPassword}" 
                     PasswordChar="●"
                     Watermark="Password for private key (if encrypted)"
                     IsEnabled="{Binding HasPrivateKey}"/>
        </StackPanel>

        <!-- Save Checkbox -->
        <CheckBox IsChecked="{Binding SaveCredentials}"
                  Content="Save credentials"/>
    </StackPanel>
</UserControl>