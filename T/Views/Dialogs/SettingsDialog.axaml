<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:T.ViewModels"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             xmlns:sys="using:System"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="500"
             x:Class="T.Views.Dialogs.SettingsDialog"
             x:DataType="vm:MainWindowViewModel">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid ColumnDefinitions="160,*" ColumnSpacing="4">
        
        <!-- Navigation -->
        <ListBox x:Name="SettingsNav"
                 SelectedIndex="0"
                 CornerRadius="6"
                 Padding="0"
                 Background="Transparent"
                 BorderThickness="0">
            <ListBoxItem Padding="12,8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <ui:SymbolIcon Symbol="Setting"/>
                    <TextBlock Text="General"/>
                </StackPanel>
            </ListBoxItem>
            <ListBoxItem Padding="12,8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <ui:SymbolIcon Symbol="Folder"/>
                    <TextBlock Text="Explorer"/>
                </StackPanel>
            </ListBoxItem>
            <ListBoxItem Padding="12,8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <ui:SymbolIcon Symbol="Code"/>
                    <TextBlock Text="Terminal"/>
                </StackPanel>
            </ListBoxItem>
        </ListBox>

        <!-- Pages -->
        <Border Grid.Column="1"
                Background="{DynamicResource LayerFillColorDefaultBrush}"
                CornerRadius="{DynamicResource ControlCornerRadius}"
                BorderBrush="{DynamicResource ControlStrokeColorDefaultBrush}"
                BorderThickness="1">
            <ScrollViewer VerticalScrollBarVisibility="Auto"
                          HorizontalScrollBarVisibility="Disabled"
                          Padding="0,0,6,0">
                <Panel Margin="8">
                    <!-- Page: General -->
                    <StackPanel IsVisible="{Binding #SettingsNav.SelectedIndex, 
                        Converter={StaticResource EqualsConverter}, ConverterParameter=0}"
                                Spacing="8">
                        <StackPanel Spacing="4">
                            <TextBlock Text="Theme"/>
                            <ComboBox SelectedItem="{Binding Settings.General.Theme}" HorizontalAlignment="Stretch">
                                <sys:String>System</sys:String>
                                <sys:String>Light</sys:String>
                                <sys:String>Dark</sys:String>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Language"/>
                            <ComboBox SelectedItem="{Binding Settings.General.Language}" HorizontalAlignment="Stretch">
                                <sys:String>System</sys:String>
                                <sys:String>English</sys:String>
                                <sys:String>Deutsch</sys:String>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Connection timeout (seconds)"/>
                            <NumericUpDown Value="{Binding Settings.General.ConnectionTimeout}"
                                           Minimum="5" Maximum="120" HorizontalAlignment="Stretch"/>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Keep-alive interval (seconds)"/>
                            <NumericUpDown Value="{Binding Settings.General.KeepAliveInterval}"
                                           Minimum="10" Maximum="120" HorizontalAlignment="Stretch"/>
                        </StackPanel>

                        <CheckBox Content="Confirm before closing window"
                                  IsChecked="{Binding Settings.General.ConfirmOnClose}"/>

                        <CheckBox Content="Reconnect sessions on startup"
                                  IsChecked="{Binding Settings.General.ReconnectOnStartup}"/>

                        <Separator Margin="0,8"/>
                        
                        <TextBlock Text="Updates" FontWeight="SemiBold" Margin="0,4,0,0"/>
                        
                        <CheckBox Content="Check for updates on startup"
                                  IsChecked="{Binding Settings.Update.CheckForUpdatesOnStartup}"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Update Channel"/>
                            <ComboBox SelectedItem="{Binding Settings.Update.UpdateChannel}" 
                                      HorizontalAlignment="Stretch">
                                <sys:String>Stable</sys:String>
                                <sys:String>Beta</sys:String>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>

                    <!-- Page: Explorer -->
                    <StackPanel IsVisible="{Binding #SettingsNav.SelectedIndex, 
                        Converter={StaticResource EqualsConverter}, ConverterParameter=1}"
                                Spacing="8">
                        <CheckBox Content="Show hidden files"
                                  IsChecked="{Binding Settings.Explorer.ShowHiddenFiles}"/>

                        <CheckBox Content="Confirm before deleting files"
                                  IsChecked="{Binding Settings.Explorer.ConfirmDelete}"/>

                        <CheckBox Content="Double-click to open directories"
                                  IsChecked="{Binding Settings.Explorer.DoubleClickToOpen}"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Sort files by"/>
                            <ComboBox SelectedItem="{Binding Settings.Explorer.SortBy}"
                                      HorizontalAlignment="Stretch">
                                <sys:String>Name</sys:String>
                                <sys:String>Size</sys:String>
                                <sys:String>Date</sys:String>
                                <sys:String>Permissions</sys:String>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Default download path"/>
                            <TextBox Text="{Binding Settings.Explorer.DefaultDownloadPath}"
                                     Watermark="Leave empty for ~/Downloads"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Page: Terminal -->
                    <StackPanel IsVisible="{Binding #SettingsNav.SelectedIndex, 
                        Converter={StaticResource EqualsConverter}, ConverterParameter=2}"
                                Spacing="8">
                        <StackPanel Spacing="4">
                            <TextBlock Text="Font family"/>
                            <ComboBox SelectedItem="{Binding Settings.Terminal.TerminalFontFamily}"
                                      HorizontalAlignment="Stretch">
                                <sys:String>Consolas</sys:String>
                                <sys:String>Cascadia Mono</sys:String>
                                <sys:String>JetBrains Mono</sys:String>
                                <sys:String>Fira Code</sys:String>
                                <sys:String>Source Code Pro</sys:String>
                                <sys:String>Courier New</sys:String>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Font size"/>
                            <NumericUpDown Value="{Binding Settings.Terminal.TerminalFontSize}"
                                           Minimum="8" Maximum="32" HorizontalAlignment="Stretch"/>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Cursor style"/>
                            <ComboBox SelectedItem="{Binding Settings.Terminal.CursorStyle}"
                                      HorizontalAlignment="Stretch">
                                <sys:String>Bar</sys:String>
                                <sys:String>Block</sys:String>
                                <sys:String>Underline</sys:String>
                            </ComboBox>
                        </StackPanel>

                        <CheckBox Content="Cursor blinking"
                                  IsChecked="{Binding Settings.Terminal.CursorBlink}"/>

                        <CheckBox Content="Enable terminal colors"
                                  IsChecked="{Binding Settings.Terminal.EnableTerminalColors}"/>

                        <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
                            <StackPanel Grid.Column="0" Spacing="4">
                                <TextBlock Text="Background color"/>
                                <TextBox Text="{Binding Settings.Terminal.TerminalBackground}"
                                         MaxLength="7" HorizontalAlignment="Stretch"/>
                            </StackPanel>
                            <StackPanel Grid.Column="1" Spacing="4">
                                <TextBlock Text="Foreground color"/>
                                <TextBox Text="{Binding Settings.Terminal.TerminalForeground}"
                                         HorizontalAlignment="Stretch"/>
                            </StackPanel>
                        </Grid>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Cursor color"/>
                            <TextBox Text="{Binding Settings.Terminal.CursorColor}"
                                     HorizontalAlignment="Stretch"/>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Scrollback lines"/>
                            <NumericUpDown Value="{Binding Settings.Terminal.ScrollbackLines}"
                                           Minimum="1000" Maximum="100000"
                                           Increment="1000" HorizontalAlignment="Stretch"/>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Terminal padding (px)"/>
                            <NumericUpDown Value="{Binding Settings.Terminal.TerminalPadding}"
                                           Minimum="0" Maximum="32" HorizontalAlignment="Stretch"/>
                        </StackPanel>
                    </StackPanel>
                </Panel>
            </ScrollViewer>
        </Border>
    </Grid>
</UserControl>